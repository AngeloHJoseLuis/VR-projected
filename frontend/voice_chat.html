<!DOCTYPE html>
<html>

<head>
    <meta charset="utf-8">
    <title>Chat de Voz en VR</title>
</head>

<body>
    <h1>Con√©ctate al chat de voz</h1>
    <button onclick="startCall()">Iniciar Llamada</button>
    <audio id="remoteAudio" autoplay></audio>

    <script>
        let peerConnection;
        const config = { iceServers: [{ urls: 'stun:stun.l.google.com:19302' }] };

        function startCall() {
            peerConnection = new RTCPeerConnection(config);

            navigator.mediaDevices.getUserMedia({ audio: true }).then(stream => {
                stream.getTracks().forEach(track => peerConnection.addTrack(track, stream));

                peerConnection.createOffer().then(offer => {
                    peerConnection.setLocalDescription(offer);
                    sendSignal(offer);
                });
            });

            peerConnection.ontrack = event => {
                document.getElementById("remoteAudio").srcObject = event.streams[0];
            };
        }

        function sendSignal(data) {
            fetch("/webrtc_signal/", {
                method: "POST",
                body: JSON.stringify({ data: data })
            });
        }
    </script>
</body>

</html>